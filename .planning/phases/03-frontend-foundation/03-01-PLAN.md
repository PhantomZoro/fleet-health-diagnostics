---
phase: 03-frontend-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/angular.json
  - frontend/tsconfig.json
  - frontend/tsconfig.app.json
  - frontend/proxy.conf.json
  - frontend/src/main.ts
  - frontend/src/app/app.component.ts
  - frontend/src/app/app.component.html
  - frontend/src/app/app.component.scss
  - frontend/src/app/app.routes.ts
  - frontend/src/app/app.config.ts
  - frontend/src/app/features/dashboard/dashboard.component.ts
  - frontend/src/app/features/events/events.component.ts
  - frontend/src/styles.scss
autonomous: true
requirements:
  - STATE-01
must_haves:
  truths:
    - "Angular dev server starts at localhost:4200 without errors"
    - "/api/* requests are proxied to localhost:3000"
    - "Navigating to / redirects to /dashboard"
    - "Sidebar nav links switch between /dashboard and /events routes"
    - "@ngrx/component-store is installed at ^19.0.0"
  artifacts:
    - path: "frontend/package.json"
      provides: "Angular 19 project dependencies including @ngrx/component-store"
      contains: "@ngrx/component-store"
    - path: "frontend/proxy.conf.json"
      provides: "API proxy configuration"
      contains: "/api"
    - path: "frontend/src/app/app.component.ts"
      provides: "App shell with sidebar nav and router outlet"
    - path: "frontend/src/app/app.routes.ts"
      provides: "Route config with dashboard and events routes"
    - path: "frontend/src/styles.scss"
      provides: "Global CSS custom properties for BMW-inspired color palette"
      contains: "--primary"
  key_links:
    - from: "frontend/angular.json"
      to: "frontend/proxy.conf.json"
      via: "proxyConfig in serve target"
      pattern: "proxyConfig"
    - from: "frontend/src/app/app.routes.ts"
      to: "frontend/src/app/features/dashboard/dashboard.component.ts"
      via: "lazy route import"
      pattern: "loadComponent.*dashboard"
---

<objective>
Scaffold Angular 19 project with routing, API proxy, ComponentStore dependency, app shell layout, and global styles.

Purpose: Creates the frontend foundation that all subsequent plans build on — project config, proxy to backend, navigation shell, route stubs, and design tokens.
Output: Running Angular dev server with sidebar navigation, two route stubs, and API proxy to backend.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-backend-api-layer/02-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Angular 19 project with proxy and ComponentStore</name>
  <files>
    frontend/package.json
    frontend/angular.json
    frontend/tsconfig.json
    frontend/tsconfig.app.json
    frontend/proxy.conf.json
    frontend/src/main.ts
    frontend/src/app/app.config.ts
  </files>
  <action>
    Generate Angular 19 project using Angular CLI:

    1. Run `npx @angular/cli@19 new frontend --standalone --style=scss --routing --skip-tests --skip-git` from project root. This creates the full Angular scaffold.

    2. Create `frontend/proxy.conf.json`:
    ```json
    {
      "/api": {
        "target": "http://localhost:3000",
        "secure": false,
        "changeOrigin": true
      }
    }
    ```

    3. Update `frontend/angular.json` — add `proxyConfig` to the serve target's options:
    ```json
    "serve": {
      "options": {
        "proxyConfig": "proxy.conf.json"
      }
    }
    ```
    Find the existing `serve` target under `projects.frontend.architect.serve` and add `proxyConfig` to its `options` object (create `options` if it doesn't exist under serve).

    4. Install NgRx ComponentStore — from `frontend/` directory:
    ```bash
    npm install @ngrx/component-store@^19.0.0
    ```
    CRITICAL: Do NOT use `@latest` — npm latest tag points to Angular 21 aligned version. Must use `^19.0.0` explicitly.

    5. Update `frontend/src/app/app.config.ts` to include `provideHttpClient()` from `@angular/common/http` and `provideRouter(routes)` from `@angular/router` in the providers array. Import `routes` from `./app.routes`. Also include `provideAnimationsAsync()` from `@angular/platform-browser/animations/async`.
  </action>
  <verify>
    Run from `frontend/`:
    - `npm ls @ngrx/component-store` shows ^19.x installed
    - `npx ng build` compiles without errors
    - Confirm `proxy.conf.json` exists and `angular.json` references it
  </verify>
  <done>
    Angular 19 project created with standalone components, SCSS, routing, proxy config pointing /api to localhost:3000, and @ngrx/component-store@^19.x installed.
  </done>
</task>

<task type="auto">
  <name>Task 2: App shell layout, routes, and global styles</name>
  <files>
    frontend/src/app/app.component.ts
    frontend/src/app/app.component.html
    frontend/src/app/app.component.scss
    frontend/src/app/app.routes.ts
    frontend/src/app/features/dashboard/dashboard.component.ts
    frontend/src/app/features/events/events.component.ts
    frontend/src/styles.scss
  </files>
  <action>
    1. Create route stub components:

    `frontend/src/app/features/dashboard/dashboard.component.ts`:
    ```typescript
    import { Component } from '@angular/core';

    @Component({
      selector: 'app-dashboard',
      standalone: true,
      template: `<section><h2>Dashboard</h2><p>Aggregated diagnostics will appear here.</p></section>`
    })
    export class DashboardComponent {}
    ```

    `frontend/src/app/features/events/events.component.ts`:
    ```typescript
    import { Component } from '@angular/core';

    @Component({
      selector: 'app-events',
      standalone: true,
      template: `<section><h2>Diagnostic Events</h2><p>Events table will appear here.</p></section>`
    })
    export class EventsComponent {}
    ```

    2. Configure routes in `frontend/src/app/app.routes.ts`:
    ```typescript
    import { Routes } from '@angular/router';

    export const routes: Routes = [
      { path: '', redirectTo: 'dashboard', pathMatch: 'full' },
      {
        path: 'dashboard',
        loadComponent: () => import('./features/dashboard/dashboard.component').then(m => m.DashboardComponent)
      },
      {
        path: 'events',
        loadComponent: () => import('./features/events/events.component').then(m => m.EventsComponent)
      }
    ];
    ```
    Use lazy loading via `loadComponent` for code splitting.

    3. Build the app shell in `app.component.ts` / `app.component.html` / `app.component.scss`:

    Template — semantic HTML with sidebar nav and main content area:
    ```html
    <div class="app-layout">
      <nav class="sidebar" role="navigation" aria-label="Main navigation">
        <div class="sidebar-header">
          <h1>Fleet Diagnostics</h1>
        </div>
        <ul class="nav-links">
          <li>
            <a routerLink="/dashboard" routerLinkActive="active" aria-current="page">
              Dashboard
            </a>
          </li>
          <li>
            <a routerLink="/events" routerLinkActive="active" aria-current="page">
              Events
            </a>
          </li>
        </ul>
      </nav>
      <main class="content">
        <router-outlet />
      </main>
    </div>
    ```

    Component class: import `RouterOutlet`, `RouterLink`, `RouterLinkActive` in the `imports` array. Set `standalone: true`.

    SCSS for app.component:
    ```scss
    .app-layout {
      display: flex;
      min-height: 100vh;
    }

    .sidebar {
      width: 240px;
      background: var(--surface-dark);
      color: var(--text-light);
      display: flex;
      flex-direction: column;
      flex-shrink: 0;
    }

    .sidebar-header {
      padding: 1.5rem 1rem;
      border-bottom: 1px solid var(--border-color);

      h1 {
        font-size: 1.125rem;
        font-weight: 600;
        margin: 0;
      }
    }

    .nav-links {
      list-style: none;
      padding: 0.5rem 0;
      margin: 0;

      li a {
        display: block;
        padding: 0.75rem 1rem;
        color: var(--text-light);
        text-decoration: none;
        transition: background-color 0.15s;

        &:hover {
          background: var(--surface-hover);
        }

        &.active {
          background: var(--primary);
          color: #ffffff;
          font-weight: 500;
        }
      }
    }

    .content {
      flex: 1;
      padding: 1.5rem 2rem;
      background: var(--surface-main);
      overflow-y: auto;
    }

    // Mobile responsive: sidebar collapses
    @media (max-width: 768px) {
      .app-layout {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        flex-direction: row;
        align-items: center;

        .sidebar-header {
          padding: 0.75rem 1rem;
          border-bottom: none;
          border-right: 1px solid var(--border-color);
        }

        .nav-links {
          display: flex;
          padding: 0;

          li a {
            padding: 0.75rem 1rem;
          }
        }
      }
    }
    ```

    4. Set global styles in `frontend/src/styles.scss`:
    ```scss
    :root {
      // BMW-inspired color palette
      --primary: #1C69D4;
      --primary-dark: #1557B0;
      --error: #D32F2F;
      --warn: #F57C00;
      --info: #1976D2;

      // Surface colors
      --surface-dark: #1a1a2e;
      --surface-main: #f5f5f5;
      --surface-card: #ffffff;
      --surface-hover: rgba(255, 255, 255, 0.08);

      // Text
      --text-dark: #212121;
      --text-secondary: #616161;
      --text-light: #e0e0e0;

      // Borders
      --border-color: rgba(255, 255, 255, 0.12);
      --border-light: #e0e0e0;

      // Spacing
      --radius: 6px;
    }

    *, *::before, *::after {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      font-size: 14px;
      color: var(--text-dark);
      background: var(--surface-main);
    }

    h1, h2, h3, h4, h5, h6 {
      margin-top: 0;
    }

    a {
      color: var(--primary);
    }
    ```
  </action>
  <verify>
    Run from `frontend/`:
    - `npx ng build` compiles without errors
    - `npx ng serve` starts dev server at localhost:4200
    - Browser at localhost:4200 shows sidebar with "Fleet Diagnostics" header, Dashboard and Events links
    - Clicking links navigates between /dashboard and /events
    - Root URL / redirects to /dashboard
  </verify>
  <done>
    App shell renders with sidebar navigation, two lazy-loaded route stubs, BMW-inspired CSS custom properties, and responsive layout that collapses sidebar on mobile.
  </done>
</task>

</tasks>

<verification>
1. `cd frontend && npx ng build` — compiles without errors
2. `cd frontend && npx ng serve` — dev server at localhost:4200
3. Browser: localhost:4200 redirects to /dashboard, sidebar nav works
4. `npm ls @ngrx/component-store` — shows 19.x
5. Verify `proxy.conf.json` exists and `angular.json` references it
</verification>

<success_criteria>
- Angular 19 project runs at localhost:4200
- /api/* proxied to localhost:3000 via proxy.conf.json
- @ngrx/component-store@^19 installed
- Sidebar nav with Dashboard and Events links, routes work
- CSS custom properties defined for BMW-inspired palette
- Responsive: sidebar collapses to horizontal on mobile
</success_criteria>

<output>
After completion, create `.planning/phases/03-frontend-foundation/03-01-SUMMARY.md`
</output>

---
phase: 04-frontend-views
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/app/shared/filter-panel/filter-panel.component.ts
  - frontend/src/app/shared/filter-panel/filter-panel.component.html
  - frontend/src/app/shared/filter-panel/filter-panel.component.scss
  - frontend/src/app/shared/severity-badge/severity-badge.component.ts
  - frontend/src/app/shared/severity-badge/severity-badge.component.scss
  - frontend/src/app/shared/pagination/pagination.component.ts
  - frontend/src/app/shared/pagination/pagination.component.html
  - frontend/src/app/shared/pagination/pagination.component.scss
  - frontend/src/app/shared/loading-spinner/loading-spinner.component.ts
  - frontend/src/app/shared/loading-spinner/loading-spinner.component.scss
autonomous: true
requirements:
  - VIEW-01
  - VIEW-03
  - VIEW-05

must_haves:
  truths:
    - "FilterPanel emits EventFilters on Apply and empty filters on Reset"
    - "SeverityBadge renders red for ERROR, orange for WARN, blue for INFO"
    - "Pagination emits page number on Prev/Next click and disables at boundaries"
    - "LoadingSpinner displays a CSS-only animated spinner overlay"
    - "All shared components use OnPush change detection and inject no store"
  artifacts:
    - path: "frontend/src/app/shared/filter-panel/filter-panel.component.ts"
      provides: "FilterPanelComponent with @Output filtersApply and filtersReset"
      contains: "changeDetection: ChangeDetectionStrategy.OnPush"
    - path: "frontend/src/app/shared/severity-badge/severity-badge.component.ts"
      provides: "SeverityBadgeComponent with @Input level"
      contains: "changeDetection: ChangeDetectionStrategy.OnPush"
    - path: "frontend/src/app/shared/pagination/pagination.component.ts"
      provides: "PaginationComponent with @Input total/page/limit and @Output pageChange"
      contains: "changeDetection: ChangeDetectionStrategy.OnPush"
    - path: "frontend/src/app/shared/loading-spinner/loading-spinner.component.ts"
      provides: "LoadingSpinnerComponent as CSS-only overlay"
      contains: "changeDetection: ChangeDetectionStrategy.OnPush"
  key_links:
    - from: "frontend/src/app/shared/filter-panel/filter-panel.component.ts"
      to: "core/models/event-filters.model.ts"
      via: "EventFilters import for @Output typing"
      pattern: "import.*EventFilters.*from.*core/models"
    - from: "frontend/src/app/shared/severity-badge/severity-badge.component.ts"
      to: "core/models/diagnostic-event.model.ts"
      via: "DiagnosticLevel import for @Input typing"
      pattern: "import.*DiagnosticLevel.*from.*core/models"
---

<objective>
Create four reusable presentational (dumb) components used across Events and Dashboard views: FilterPanel, SeverityBadge, Pagination, and LoadingSpinner.

Purpose: These components encapsulate UI behavior with no store dependency — they communicate purely through @Input/@Output. This is the BMW coding assignment's smart/dumb component split pattern.

Output: Four standalone Angular components in `frontend/src/app/shared/`, each with OnPush change detection, semantic HTML, and ARIA attributes.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@frontend/src/app/core/models/index.ts
@frontend/src/app/core/models/event-filters.model.ts
@frontend/src/app/core/models/diagnostic-event.model.ts
@frontend/src/styles.scss
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FilterPanel and SeverityBadge components</name>
  <files>
    frontend/src/app/shared/filter-panel/filter-panel.component.ts
    frontend/src/app/shared/filter-panel/filter-panel.component.html
    frontend/src/app/shared/filter-panel/filter-panel.component.scss
    frontend/src/app/shared/severity-badge/severity-badge.component.ts
    frontend/src/app/shared/severity-badge/severity-badge.component.scss
  </files>
  <action>
    **FilterPanelComponent** (`frontend/src/app/shared/filter-panel/`):

    Component file (`filter-panel.component.ts`):
    - Standalone component with `ChangeDetectionStrategy.OnPush`
    - `@Input() filters: EventFilters = {}` — allows parent to pre-populate filter values (e.g., when navigating from dashboard with vehicleId)
    - `@Output() filtersApply = new EventEmitter<EventFilters>()` — emits assembled filters on Apply
    - `@Output() filtersReset = new EventEmitter<void>()` — emits on Reset
    - Local form state: `vehicleId`, `code`, `level`, `dateFrom`, `dateTo` — initialized from `@Input() filters` using `ngOnChanges` or `input()` signal
    - `onApply()`: assembles non-empty fields into EventFilters object, emits via `filtersApply`
    - `onReset()`: clears all local fields, emits via `filtersReset`
    - Import `FormsModule` for template-driven ngModel binding (simple forms, no reactive forms overhead)
    - Import `DiagnosticLevel` type from `../core/models` for severity options typing

    Template file (`filter-panel.component.html`):
    - Wrap in `<fieldset>` with `<legend>Filters</legend>` (semantic HTML)
    - Vehicle ID: `<label>` + `<input type="text" [(ngModel)]="vehicleId" placeholder="e.g. VH-1001">`
    - Error Code: `<label>` + `<input type="text" [(ngModel)]="code" placeholder="e.g. P0300">`
    - Severity: `<label>` + `<select [(ngModel)]="level">` with options: All (value=""), ERROR, WARN, INFO
    - Date From: `<label>` + `<input type="datetime-local" [(ngModel)]="dateFrom">`
    - Date To: `<label>` + `<input type="datetime-local" [(ngModel)]="dateTo">`
    - Buttons: `<button type="button" (click)="onApply()">Apply</button>` + `<button type="button" (click)="onReset()">Reset</button>`
    - Add `aria-label` attributes on inputs for accessibility
    - Apply button should have `class="btn-primary"`, Reset button `class="btn-secondary"`

    Styles file (`filter-panel.component.scss`):
    - `fieldset`: no default border, use CSS custom property `--border-light` for subtle bottom border, padding 16px
    - Flex layout: filter inputs in a row that wraps on small screens (`display: flex; flex-wrap: wrap; gap: 12px`)
    - Each filter field: `flex: 1 1 180px` (responsive wrapping)
    - Labels: block display above inputs, `color: var(--text-secondary)`, font-size 12px, margin-bottom 4px
    - Inputs/select: full width, padding 8px 12px, border 1px solid var(--border-light), border-radius var(--radius), font-size 14px
    - `.btn-primary`: background var(--primary), color white, padding 8px 20px, border-radius var(--radius), cursor pointer, hover darker
    - `.btn-secondary`: background transparent, border 1px solid var(--border-light), padding 8px 20px, cursor pointer
    - Button container: `margin-left: auto` to push buttons right

    **SeverityBadgeComponent** (`frontend/src/app/shared/severity-badge/`):

    Component file (`severity-badge.component.ts`):
    - Standalone component with `ChangeDetectionStrategy.OnPush`, inline template
    - `@Input({ required: true }) level!: DiagnosticLevel`
    - Template: `<span class="badge" [class]="'badge--' + level.toLowerCase()" [attr.aria-label]="level + ' severity'">{{ level }}</span>`
    - Import `DiagnosticLevel` from `../../core/models`

    Styles file (`severity-badge.component.scss`):
    - `.badge`: inline-block, padding 2px 8px, border-radius 3px, font-size 11px, font-weight 600, text-transform uppercase, letter-spacing 0.5px
    - `.badge--error`: background `rgba(211, 47, 47, 0.12)`, color `var(--error)` (#D32F2F) — RED
    - `.badge--warn`: background `rgba(245, 124, 0, 0.12)`, color `var(--warn)` (#F57C00) — ORANGE
    - `.badge--info`: background `rgba(25, 118, 210, 0.12)`, color `var(--info)` (#1976D2) — BLUE
  </action>
  <verify>
    Run `cd frontend && npx ng build --configuration development 2>&1 | tail -5` — must compile with zero errors. Verify files exist:
    - `frontend/src/app/shared/filter-panel/filter-panel.component.ts`
    - `frontend/src/app/shared/severity-badge/severity-badge.component.ts`
    Grep for `ChangeDetectionStrategy.OnPush` in both files.
    Grep for `DiagnosticsStore` in both files — must NOT appear (dumb components).
  </verify>
  <done>
    FilterPanelComponent exists with vehicleId, code, severity, dateFrom, dateTo fields, Apply + Reset buttons, emits EventFilters. SeverityBadgeComponent exists with colored badge (red/orange/blue) based on DiagnosticLevel input. Both use OnPush, neither injects store.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Pagination and LoadingSpinner components</name>
  <files>
    frontend/src/app/shared/pagination/pagination.component.ts
    frontend/src/app/shared/pagination/pagination.component.html
    frontend/src/app/shared/pagination/pagination.component.scss
    frontend/src/app/shared/loading-spinner/loading-spinner.component.ts
    frontend/src/app/shared/loading-spinner/loading-spinner.component.scss
  </files>
  <action>
    **PaginationComponent** (`frontend/src/app/shared/pagination/`):

    Component file (`pagination.component.ts`):
    - Standalone component with `ChangeDetectionStrategy.OnPush`
    - `@Input({ required: true }) total!: number` — total items count
    - `@Input({ required: true }) page!: number` — current page (1-based)
    - `@Input({ required: true }) limit!: number` — items per page
    - `@Output() pageChange = new EventEmitter<number>()`
    - Getter `totalPages(): number` → `Math.ceil(this.total / this.limit)` (guard against 0 limit)
    - Getter `hasPrev(): boolean` → `this.page > 1`
    - Getter `hasNext(): boolean` → `this.page < this.totalPages`
    - `onPrev()`: if hasPrev, emit `this.page - 1`
    - `onNext()`: if hasNext, emit `this.page + 1`
    - Import nothing from store or services — pure dumb component

    Template file (`pagination.component.html`):
    - `<nav class="pagination" role="navigation" aria-label="Pagination">`
    - Prev button: `<button (click)="onPrev()" [disabled]="!hasPrev" aria-label="Previous page">&#8592; Prev</button>`
    - Page info: `<span class="page-info">Page {{ page }} of {{ totalPages }}</span>`
    - Next button: `<button (click)="onNext()" [disabled]="!hasNext" aria-label="Next page">Next &#8594;</button>`
    - Show total: `<span class="total-info">{{ total }} total events</span>`

    Styles file (`pagination.component.scss`):
    - `.pagination`: display flex, align-items center, justify-content center, gap 12px, padding 12px 0
    - Buttons: padding 6px 14px, border 1px solid var(--border-light), background var(--surface-card), border-radius var(--radius), cursor pointer, font-size 13px
    - Buttons `:disabled`: opacity 0.4, cursor not-allowed
    - Buttons `:hover:not(:disabled)`: background var(--primary), color white, border-color var(--primary)
    - `.page-info`: font-size 13px, color var(--text-secondary)
    - `.total-info`: font-size 12px, color var(--text-secondary), margin-left auto

    **LoadingSpinnerComponent** (`frontend/src/app/shared/loading-spinner/`):

    Component file (`loading-spinner.component.ts`):
    - Standalone component with `ChangeDetectionStrategy.OnPush`, inline template
    - Template: `<div class="spinner-overlay" role="status" aria-label="Loading"><div class="spinner"></div></div>`
    - No inputs, no outputs — just a visual overlay element. Parent controls visibility with `@if (loading)` in their template.

    Styles file (`loading-spinner.component.scss`):
    - `.spinner-overlay`: position absolute, inset 0, display flex, align-items center, justify-content center, background rgba(255,255,255,0.7), z-index 10
    - `.spinner`: width 36px, height 36px, border 3px solid var(--border-light), border-top-color var(--primary), border-radius 50%, animation `spin 0.8s linear infinite`
    - `@keyframes spin`: `0% { transform: rotate(0deg) } 100% { transform: rotate(360deg) }`
  </action>
  <verify>
    Run `cd frontend && npx ng build --configuration development 2>&1 | tail -5` — must compile with zero errors. Verify files exist:
    - `frontend/src/app/shared/pagination/pagination.component.ts`
    - `frontend/src/app/shared/loading-spinner/loading-spinner.component.ts`
    Grep for `ChangeDetectionStrategy.OnPush` in both files.
    Grep for `DiagnosticsStore` in both files — must NOT appear.
  </verify>
  <done>
    PaginationComponent exists with Prev/Next buttons, page info display, disabled state at boundaries, emits page number. LoadingSpinnerComponent exists with CSS-only animated spinner overlay. Both use OnPush, neither injects store.
  </done>
</task>

</tasks>

<verification>
1. All four component directories exist under `frontend/src/app/shared/`
2. `ng build --configuration development` passes with zero errors
3. No component imports `DiagnosticsStore` (dumb component rule)
4. All four components have `ChangeDetectionStrategy.OnPush`
5. FilterPanelComponent has `@Output() filtersApply` and `@Output() filtersReset`
6. SeverityBadgeComponent has three color classes (error=red, warn=orange, info=blue)
7. PaginationComponent has `@Output() pageChange`
8. LoadingSpinnerComponent has CSS-only spinner animation
</verification>

<success_criteria>
- Four shared components created, all compile successfully
- FilterPanel has vehicleId, code, severity, date range fields with Apply/Reset
- SeverityBadge renders colored badges matching severity level
- Pagination renders Prev/Next with boundary-aware disabled states
- LoadingSpinner shows CSS-only animated overlay
- All components: standalone, OnPush, no store injection, semantic HTML with ARIA
</success_criteria>

<output>
After completion, create `.planning/phases/04-frontend-views/04-01-SUMMARY.md`
</output>
